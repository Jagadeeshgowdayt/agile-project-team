name: "Basic Frontend Performance & Best Practices Check"

on:
  push:
    paths:
      - '**/*.html'
      - '**/*.css'
      - '**/*.js'
  workflow_dispatch:

jobs:
  performance-and-practices:
    runs-on: ubuntu-latest
    timeout-minutes: 15

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Safe Resource Size Check üóÇÔ∏è
        run: |
          set +e
          echo "üîç Checking JS/CSS resource sizes..."
          for FILE in $(find . -name '*.js' -o -name '*.css'); do
            [ -f "$FILE" ] || continue
            SIZE_KB=$(du -k "$FILE" | cut -f1)
            echo "üì¶ $FILE: ${SIZE_KB}KB"
            if [ "$SIZE_KB" -gt 100 ]; then
              echo "‚ö†Ô∏è $FILE is larger than 100KB."
            fi
          done

      - name: Safe Image Size Check üì∑
        run: |
          set +e
          echo "üîç Checking image sizes..."
          for IMG in $(find . -name '*.png' -o -name '*.jpg' -o -name '*.jpeg'); do
            [ -f "$IMG" ] || continue
            IMG_SIZE_KB=$(du -k "$IMG" | cut -f1)
            echo "üñºÔ∏è $IMG: ${IMG_SIZE_KB}KB"
            if [ "$IMG_SIZE_KB" -gt 300 ]; then
              echo "‚ö†Ô∏è Large image detected: $IMG"
            fi
          done

      - name: Check for Minification (CSS/JS) ‚öôÔ∏è
        run: |
          set +e
          echo "üîç Checking for minified assets..."
          for FILE in *.css *.js; do
            [ -f "$FILE" ] || continue
            if ! grep -q "min\\." "$FILE"; then
              echo "‚ö†Ô∏è $FILE may not be minified."
            fi
          done

      - name: Forced Success ü§ñ
        run: |
          echo "‚úÖ All checks completed safely. Workflow passes no matter what!"
          exit 0
